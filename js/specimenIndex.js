!function(modules){function __webpack_require__(moduleId){if(installedModules[moduleId])return installedModules[moduleId].exports;var module=installedModules[moduleId]={exports:{},id:moduleId,loaded:!1};return modules[moduleId].call(module.exports,module,module.exports,__webpack_require__),module.loaded=!0,module.exports}var installedModules={};return __webpack_require__.m=modules,__webpack_require__.c=installedModules,__webpack_require__.p="",__webpack_require__(0)}([function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var _specimen=__webpack_require__(18),_specimen2=_interopRequireDefault(_specimen),args=QueryString.get(document.currentScript.src);$(function(){var biobankSpecimen=React.createElement("div",{className:"page-specimen-form"},React.createElement("div",{className:"row"},React.createElement("div",{className:"col-md-9 col-lg-12"},React.createElement(_specimen2.default,{specimenPageDataURL:loris.BaseURL+"/biobank/ajax/SpecimenInfo.php?action=getSpecimenData&barcode="+args.barcode}))));ReactDOM.render(biobankSpecimen,document.getElementById("lorisworkspace"))})},,function(module,exports){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),Panel=function(_React$Component){function Panel(props){_classCallCheck(this,Panel);var _this=_possibleConstructorReturn(this,(Panel.__proto__||Object.getPrototypeOf(Panel)).call(this,props));return _this.state={collapsed:_this.props.initCollapsed},_this.panelClass=_this.props.initCollapsed?"panel-collapse collapse":"panel-collapse collapse in",_this.toggleCollapsed=_this.toggleCollapsed.bind(_this),_this}return _inherits(Panel,_React$Component),_createClass(Panel,[{key:"toggleCollapsed",value:function(){this.setState({collapsed:!this.state.collapsed})}},{key:"render",value:function(){var glyphClass=this.state.collapsed?"glyphicon pull-right glyphicon-chevron-down":"glyphicon pull-right glyphicon-chevron-up",pencilGlyph=void 0;this.props.edit&&(pencilGlyph=React.createElement("span",{className:"glyphicon pull-right glyphicon-pencil",style:{marginRight:"10px",cursor:"pointer"},onClick:this.props.edit}));var plusGlyph=void 0;this.props.add&&(plusGlyph=React.createElement("span",{className:"glyphicon pull-right glyphicon-plus",style:{marginRight:"10px",cursor:"pointer"},onClick:this.props.add}));var removeGlyph=void 0;this.props.cancel&&(removeGlyph=React.createElement("span",{className:"glyphicon pull-right glyphicon-remove",style:{marginRight:"10px",cursor:"pointer"},onClick:this.props.cancel}));var panelHeading=this.props.title?React.createElement("div",{className:"panel-heading"},React.createElement("span",{className:glyphClass,onClick:this.toggleCollapsed,"data-toggle":"collapse","data-target":"#"+this.props.id,style:{cursor:"pointer"}}),pencilGlyph,plusGlyph,removeGlyph,this.props.title):"";return React.createElement("div",{className:"panel panel-primary"},panelHeading,React.createElement("div",{id:this.props.id,className:this.panelClass,role:"tabpanel"},React.createElement("div",{className:"panel-body",style:{height:this.props.height}},this.props.children)))}}]),Panel}(React.Component);Panel.propTypes={id:React.PropTypes.string,height:React.PropTypes.string,title:React.PropTypes.string,edit:React.PropTypes.func,add:React.PropTypes.func},Panel.defaultProps={initCollapsed:!1,id:"default-panel",height:"100%"},exports.default=Panel},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_barcodeForm=__webpack_require__(4),_barcodeForm2=_interopRequireDefault(_barcodeForm),BiobankSpecimenForm=function(_React$Component){function BiobankSpecimenForm(props){_classCallCheck(this,BiobankSpecimenForm);var _this=_possibleConstructorReturn(this,(BiobankSpecimenForm.__proto__||Object.getPrototypeOf(BiobankSpecimenForm)).call(this,props));return _this.state={formData:{},barcodeFormList:{},errorMessage:null,formErrors:{},countBarcodeForms:[1]},_this.handleSubmit=_this.handleSubmit.bind(_this),_this.validateForm=_this.validateForm.bind(_this),_this.setFormData=_this.setFormData.bind(_this),_this.specimenSubmit=_this.specimenSubmit.bind(_this),_this.addBarcodeForm=_this.addBarcodeForm.bind(_this),_this.setBarcodeFormData=_this.setBarcodeFormData.bind(_this),_this}return _inherits(BiobankSpecimenForm,_React$Component),_createClass(BiobankSpecimenForm,[{key:"componentDidMount",value:function(){if(this.props.child){var formData=this.state.formData;formData.parentSpecimen=this.props.specimenId,formData.pscid=this.props.candidateId,formData.visitLabel=this.props.sessionId,formData.unitId=this.props.unitId,this.setState({formData:formData})}}},{key:"render",value:function(){for(var _this2=this,barcodeForms=[],_loop=function(i){barcodeForms.push(React.createElement(_barcodeForm2.default,{setParentFormData:_this2.setBarcodeFormData,id:_this2.state.countBarcodeForms[i],specimenTypes:_this2.props.specimenTypes,containerTypesPrimary:_this2.props.containerTypesPrimary,containersNonPrimary:_this2.props.containersNonPrimary,specimenTypeAttributes:_this2.props.specimenTypeAttributes,attributeDatatypes:_this2.props.attributeDatatypes,capacities:_this2.props.capacities,containerDimensions:_this2.props.containerDimensions,containerCoordinates:_this2.props.containerCoordinates,specimenTypeUnits:_this2.props.specimenTypeUnits,units:_this2.props.units,removeBarcodeForm:i+1!==1?function(){return _this2.removeBarcodeForm(i)}:null,addBarcodeForm:i+1===_this2.state.countBarcodeForms.length?_this2.addBarcodeForm:null,duplicateBarcodeForm:i+1===_this2.state.countBarcodeForms.length?_this2.duplicateBarcodeForm:null}))},i=0;i<this.state.countBarcodeForms.length;i++)_loop(i);var globalFields=void 0,remainingQuantityFields=void 0;return this.props.child?(globalFields=React.createElement("div",null,React.createElement(StaticElement,{label:"Parent Specimen",text:this.props.barcode}),React.createElement(StaticElement,{label:"PSCID",text:this.props.pscid}),React.createElement(StaticElement,{label:"Visit Label",text:this.props.visit})),remainingQuantityFields=React.createElement("div",null,React.createElement(TextboxElement,{name:"quantity",label:"Remaining Quantity",onUserInput:this.setFormData,required:!0,value:this.state.formData.quantity}),React.createElement(SelectElement,{name:"unitId",label:"Unit",options:this.props.specimenUnits,onUserInput:this.setFormData,emptyOption:!1,required:!0,value:this.state.formData.unitId}))):globalFields=React.createElement("div",null,React.createElement(SelectElement,{name:"pscid",label:"PSCID",options:this.props.pSCIDs,onUserInput:this.setFormData,ref:"pscid",required:!0,value:this.state.formData.pscid}),React.createElement(SelectElement,{name:"visitLabel",label:"Visit Label",options:this.state.visits,onUserInput:this.setFormData,ref:"visitLabel",required:!0,value:this.state.formData.visitLabel,disabled:!this.state.formData.pscid})),React.createElement(FormElement,{name:"specimenForm",id:"specimenForm",onSubmit:this.handleSubmit,ref:"form"},React.createElement("br",null),React.createElement("div",{className:"row"},React.createElement("div",{className:"col-xs-11"},globalFields)),barcodeForms,React.createElement("div",{className:"row"},React.createElement("div",{className:"col-xs-11"},remainingQuantityFields)),React.createElement("div",{className:"col-xs-3 col-xs-offset-9"},React.createElement(ButtonElement,{label:"Submit"})))}},{key:"validateForm",value:function(formElement,value){var _this3=this,formErrors=this.state.formErrors;"barcode"===formElement&&""!==value&&(/^hello/.test(this.state.formData.barcode)?formErrors.barcode=!1:formErrors.barcode=!0),"quantity"===formElement&&""!==value&&(isNaN(value)||value>this.props.capacities[this.state.currentContainerType]?formErrors.quantity=!0:formErrors.quantity=!1);var specimenTypeFieldsObject=this.props.specimenTypeAttributes[this.state.currentSpecimenType];Object.keys(specimenTypeFieldsObject).map(function(attribute){var datatype=_this3.props.attributeDatatypes[specimenTypeFieldsObject[attribute].datatypeId].datatype;"number"===datatype&&formElement===attribute&&(isNaN(value)&&""!==value?formErrors[attribute]=!0:formErrors[attribute]=!1)});this.setState({formErrors:formErrors})}},{key:"handleSubmit",value:function(e){e.preventDefault();var formData=this.state.formData,formRefs=(this.state.barcodeFormList,this.refs);this.isValidForm(formRefs,formData)&&this.specimenSubmit()}},{key:"specimenSubmit",value:function(){var formData=this.state.formData,barcodeFormList=this.state.barcodeFormList;formData.barcodeFormList=JSON.stringify(barcodeFormList);var formObj=new FormData;for(var key in formData)""!==formData[key]&&formObj.append(key,formData[key]);$.ajax({type:"POST",url:this.props.action,data:formObj,cache:!1,contentType:!1,processData:!1,xhr:function(){var xhr=new window.XMLHttpRequest;return xhr}.bind(this),success:function(){var event=new CustomEvent("update-datatable");window.dispatchEvent(event),this.props.refreshParent(),swal("Specimen Submission Successful!","","success"),this.props.onSuccess()}.bind(this),error:function(err){console.error(err);var msg=err.responseJSON?err.responseJSON.message:"Specimen error!";this.setState({errorMessage:msg}),swal(msg,"","error")}.bind(this)})}},{key:"isValidForm",value:function isValidForm(formRefs,formData){var isValidForm=!0,requiredFields={pscid:null,visitLabel:null};return Object.keys(requiredFields).map(function(field){formData[field]?requiredFields[field]=formData[field]:formRefs[field]&&(formRefs[field].props.hasError=!0,isValidForm=!1)}),this.forceUpdate(),isValidForm}},{key:"setFormData",value:function(formElement,value){"pscid"===formElement&&""!==value&&(this.state.visits=this.props.sessionData[this.props.pSCIDs[value]].visits);var formData=this.state.formData;formData[formElement]=value,this.setState({formData:formData})}},{key:"setBarcodeFormData",value:function(barcodeFormData,barcodeId){var formData=this.state.formData,barcodeFormList=this.state.barcodeFormList;barcodeFormList[barcodeId]=barcodeFormData,formData.barcodeFormList=barcodeFormList,this.setState({formData:formData})}},{key:"addBarcodeForm",value:function(){var countBarcodeForms=this.state.countBarcodeForms;countBarcodeForms.push(countBarcodeForms[countBarcodeForms.length-1]+1),this.setState({countBarcodeForms:countBarcodeForms})}},{key:"duplicateBarcodeForm",value:function(){}},{key:"removeBarcodeForm",value:function(index){var countBarcodeForms=this.state.countBarcodeForms;countBarcodeForms.splice(index,1),this.setState({countBarcodeForms:countBarcodeForms})}}]),BiobankSpecimenForm}(React.Component);BiobankSpecimenForm.propTypes={DataURL:React.PropTypes.string.isRequired,action:React.PropTypes.string.isRequired,barcode:React.PropTypes.string,refreshTable:React.PropTypes.func},exports.default=BiobankSpecimenForm},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_collectionForm=__webpack_require__(5),_collectionForm2=_interopRequireDefault(_collectionForm),BiobankBarcodeForm=function(_React$Component){function BiobankBarcodeForm(props){_classCallCheck(this,BiobankBarcodeForm);var _this=_possibleConstructorReturn(this,(BiobankBarcodeForm.__proto__||Object.getPrototypeOf(BiobankBarcodeForm)).call(this,props));return _this.state={formData:{},formErrors:{}},_this.setFormData=_this.setFormData.bind(_this),_this.setCollectionFormData=_this.setCollectionFormData.bind(_this),_this.setParentFormData=_this.setParentFormData.bind(_this),_this}return _inherits(BiobankBarcodeForm,_React$Component),_createClass(BiobankBarcodeForm,[{key:"componentDidMount",value:function(){this.props.duplicateBarcodeForm}},{key:"render",value:function(){var addBarcodeFormButton=void 0,duplicateBarcodeFormButton=void 0;this.props.addBarcodeForm&&(addBarcodeFormButton=React.createElement("button",{type:"button",className:"btn btn-success btn-sm",onClick:this.props.addBarcodeForm},React.createElement("span",{className:"glyphicon glyphicon-plus",style:{marginRight:5}}),"New")),this.props.duplicateBarcodeForm&&(duplicateBarcodeFormButton=React.createElement("button",{type:"button",className:"btn btn-success btn-sm",onClick:this.props.duplicateBarcodeForm},React.createElement("span",{className:"glyphicon glyphicon-plus",style:{marginRight:5}}),"Duplicate"));var removeBarcodeFormButton=void 0;if(this.props.removeButton){var glyphStyle={color:"#DDDDDD",maring:"auto"},buttonStyle={appearance:"non",outline:"non",boxShadow:"none",borderColor:"transparent",backgroundColor:"transparent"};removeBarcodeFormButton=React.createElement("button",{type:"button",className:"btn btn-primary-outline btn-sm",style:buttonStyle,onClick:this.props.removeBarcodeForm},React.createElement("span",{className:"glyphicon glyphicon-remove",style:glyphStyle}))}return React.createElement(FormElement,{name:"biobankBarcode"},React.createElement("div",{className:"row"},React.createElement("div",{className:"col-xs-11"},React.createElement("div",{"data-toggle":"collapse","data-target":"#"+this.props.id},React.createElement(TextboxElement,{name:"barcode",label:"Barcode "+this.props.id,onUserInput:this.setFormData,ref:"barcode",required:!0,value:this.state.formData.barcode,hasError:this.state.formErrors.barcode,errorMessage:"Incorrect Barcode format for this Specimen and Container Type"}))),React.createElement("div",{className:"col-xs-1"},removeBarcodeFormButton)),React.createElement("div",{className:"row"},React.createElement("div",{className:"col-xs-2"}),React.createElement("div",{className:"col-xs-9"},React.createElement("div",{id:this.props.id,className:"collapse"},React.createElement(_collectionForm2.default,{setParentFormData:this.setCollectionFormData,specimenTypes:this.props.specimenTypes,specimenTypeAttributes:this.props.specimenTypeAttributes,attributeDatatypes:this.props.attributeDatatypes,containerTypesPrimary:this.props.containerTypesPrimary,containersNonPrimary:this.props.containersNonPrimary,containerDimensions:this.props.containerDimensions,containerCoordinates:this.props.containerCoordinates,specimenTypeUnits:this.props.specimenTypeUnits,stati:this.props.stati})))),React.createElement("div",{className:"row"},React.createElement("div",{className:"col-xs-11"},React.createElement("div",{className:"col-xs-3"}),React.createElement("div",{className:"col-xs-1"},addBarcodeFormButton),React.createElement("div",{className:"col-xs-1"},duplicateBarcodeFormButton))))}},{key:"setFormData",value:function(formElement,value){var formData=this.state.formData;formData[formElement]=value,this.setState({formData:formData},this.setParentFormData)}},{key:"setCollectionFormData",value:function(collectionFormData){var formData=this.state.formData;for(var field in collectionFormData)formData[field]=collectionFormData[field];this.setState({formData:formData},this.setParentFormData)}},{key:"setParentFormData",value:function(){this.props.setParentFormData(this.state.formData,this.props.id)}}]),BiobankBarcodeForm}(React.Component);BiobankBarcodeForm.propTypes={id:React.PropTypes.string,specimenTypes:React.PropTypes.object.isRequired,containerTypesPrimary:React.PropTypes.object.isRequired,specimenTypeAttributes:React.PropTypes.object.isRequired,attributeDatatypes:React.PropTypes.object.isRequired,capacities:React.PropTypes.object.isRequired},exports.default=BiobankBarcodeForm},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_containerParentForm=__webpack_require__(6),_containerParentForm2=_interopRequireDefault(_containerParentForm),SpecimenCollectionForm=function(_React$Component){function SpecimenCollectionForm(props){_classCallCheck(this,SpecimenCollectionForm);var _this=_possibleConstructorReturn(this,(SpecimenCollectionForm.__proto__||Object.getPrototypeOf(SpecimenCollectionForm)).call(this,props));return _this.state={formData:{data:{}},currentSpecimenType:_this.props.edit?_this.props.specimenType:null,currentContainerType:_this.props.edit?_this.props.containerType:null,formErrors:{}},_this.setFormData=_this.setFormData.bind(_this),_this.setSpecimenTypeFieldFormData=_this.setSpecimenTypeFieldFormData.bind(_this),_this.setParentFormData=_this.setParentFormData.bind(_this),_this.setContainerParentFormData=_this.setContainerParentFormData.bind(_this),_this.getSpecimenTypeFields=_this.getSpecimenTypeFields.bind(_this),_this.handleUpdate=_this.handleUpdate.bind(_this),_this.updateSpecimen=_this.updateSpecimen.bind(_this),_this}return _inherits(SpecimenCollectionForm,_React$Component),_createClass(SpecimenCollectionForm,[{key:"componentDidMount",value:function(){var _this2=this,formData=this.state.formData;if(this.props.edit){formData.specimenId=this.props.specimenId,formData.containerId=this.props.containerId,formData.specimenType=this.props.specimenType,formData.containerType=this.props.containerType,formData.quantity=this.props.collection.quantity,formData.unitId=this.props.collection.unitId,formData.date=this.props.collection.date,formData.time=this.props.collection.time,formData.comments=this.props.collection.comments;var specimenTypeFieldsObject=this.props.specimenTypeAttributes[this.state.currentSpecimenType];if(specimenTypeFieldsObject){Object.keys(specimenTypeFieldsObject).map(function(attribute){formData.data[attribute]=_this2.props.collection.data[attribute]})}}this.setState({formData:formData})}},{key:"mapFormOptions",value:function(rawObject,targetAttribute){var data={};for(var id in rawObject)data[id]=rawObject[id][targetAttribute];return data}},{key:"render",value:function(){var containerParentForm;this.props.edit||(containerParentForm=React.createElement(_containerParentForm2.default,{setParentFormData:this.setContainerParentFormData,containersNonPrimary:this.props.containersNonPrimary,containerDimensions:this.props.containerDimensions,containerCoordinates:this.props.containerCoordinates}));var updateButton;this.props.edit&&(updateButton=React.createElement(ButtonElement,{label:"Update"}));var specimenTypeUnits={};if(this.state.currentSpecimenType){for(var id in this.props.specimenTypeUnits[this.state.currentSpecimenType])specimenTypeUnits[id]=this.props.specimenTypeUnits[this.state.currentSpecimenType][id].unit;var specimenTypeFieldsObject=this.props.specimenTypeAttributes[this.state.currentSpecimenType];if(specimenTypeFieldsObject)var specimenTypeFields=this.getSpecimenTypeFields(specimenTypeFieldsObject)}var specimenFields;return this.state.currentSpecimenType&&(specimenFields=React.createElement("div",null,React.createElement(SelectElement,{name:"containerType",label:"Container Type",options:this.props.containerTypesPrimary,onUserInput:this.setFormData,ref:"containerType",required:!0,value:this.state.formData.containerType}),containerParentForm,React.createElement(TextboxElement,{name:"quantity",label:"Quantity",onUserInput:this.setFormData,ref:"quantity",required:!0,value:this.state.formData.quantity,hasError:this.state.formErrors.quantity}),React.createElement(SelectElement,{name:"unitId",label:"Unit",options:specimenTypeUnits,onUserInput:this.setFormData,required:!0,value:this.state.formData.unitId}),specimenTypeFields,React.createElement(DateElement,{name:"date",label:"Date",minYear:"2000",maxYear:"2018",onUserInput:this.setFormData,required:!0,value:this.state.formData.date}),React.createElement(TimeElement,{name:"time",label:"Time",onUserInput:this.setFormData,required:!0,value:this.state.formData.time}),React.createElement(TextareaElement,{name:"comments",label:"Comments",onUserInput:this.setFormData,ref:"comments",value:this.state.formData.comments}))),React.createElement(FormElement,{name:"biobankSpecimen",onSubmit:this.handleUpdate,ref:"form"},React.createElement(SelectElement,{name:"specimenType",label:"Specimen Type",options:this.props.specimenTypes,onUserInput:this.setFormData,ref:"specimenType",required:!0,value:this.state.formData.specimenType}),specimenFields,updateButton)}},{key:"setFormData",value:function(formElement,value){var formData=this.state.formData;formData[formElement]=value,"specimenType"===formElement&&""!==value&&(this.props.edit&&swal({title:"Warning",text:"Changing the specimen type will result in the loss of any preparation or anaylsis data for this specimen. You will also need to manually change the specimen type of any aliquots derived from this specimen. Proceed with caution.",type:"warning",showCancelButton:!0,confirmButtonText:"Cancel Change",cancelButtonText:"Proceed"},function(isConfirm){isConfirm&&this.props.toggleEdit()}.bind(this)),formData.data={},this.setState({currentSpecimenType:value})),"containerType"===formElement&&""!==value&&this.setState({currentContainerType:value}),this.setState({formData:formData},this.setParentFormData)}},{key:"setSpecimenTypeFieldFormData",value:function(formElement,value){var formData=this.state.formData;formData.data[formElement]=value,this.setState({formData:formData},this.setParentFormData)}},{key:"setContainerParentFormData",value:function(containerParentFormData){var formData=this.state.formData;for(var field in containerParentFormData)formData[field]=containerParentFormData[field];this.setState({formData:formData},this.setParentFormData)}},{key:"setParentFormData",value:function(){if(!this.props.edit){var formData=this.state.formData;this.props.setParentFormData(formData)}}},{key:"getSpecimenTypeFields",value:function(fieldsObject){var _this3=this,specimenTypeFields=Object.keys(fieldsObject).map(function(attribute){var datatype=_this3.props.attributeDatatypes[fieldsObject[attribute].datatypeId].datatype;if("text"===datatype||"number"===datatype){if(null==fieldsObject[attribute].refTableId)return React.createElement(TextboxElement,{name:attribute,label:fieldsObject[attribute].name,onUserInput:_this3.setSpecimenTypeFieldFormData,ref:attribute,required:fieldsObject[attribute].required,value:_this3.state.formData.data[attribute],hasError:_this3.state.formErrors[attribute],errorMessage:"This is a "+datatype+" field."});if(null!==fieldsObject[attribute].refTableId)return React.createElement(SelectElement,{name:attribute,label:fieldsObject[attribute].name,options:"",onUserInput:_this3.setSpecimenTypeFieldFormData,ref:attribute,required:fieldsObject[attribte].required,value:_this3.state.formData.data[attribute]})}if("datetime"===datatype)return React.createElement(DateElement,{name:attribute,label:fieldsObject[attribute].name,onUserInput:_this3.setSpecimenTypeFieldFormData,ref:attribute,required:fieldsObject[attribute].required,value:_this3.state.formData.data[attribute]})});return specimenTypeFields}},{key:"handleUpdate",value:function(e){this.updateSpecimen()}},{key:"updateSpecimen",value:function(){var _$$ajax,formData=this.state.formData;formData.data=JSON.stringify(formData.data);var formObj=new FormData;for(var key in formData)""!==formData[key]&&formObj.append(key,formData[key]);$.ajax((_$$ajax={type:"POST",url:this.props.action,data:formObj,cache:!1,contentType:!1,processData:!1},_defineProperty(_$$ajax,"processData",!1),_defineProperty(_$$ajax,"xhr",function(){var xhr=new window.XMLHttpRequest;return xhr}.bind(this)),_defineProperty(_$$ajax,"success",function(){formData.data=JSON.parse(formData.data),this.props.refreshParent()}.bind(this)),_defineProperty(_$$ajax,"error",function(err){console.error(err);var msg=err.responseJSON?err.responseJSON.message:"Specimen error!";this.setState({errorMessage:msg}),swal(msg,"","error")}.bind(this)),_$$ajax))}}]),SpecimenCollectionForm}(React.Component);SpecimenCollectionForm.propTypes={setParentFormData:React.PropTypes.func,specimenTypes:React.PropTypes.object.isRequired,containerTypesPrimary:React.PropTypes.object.isRequired,specimenTypeAttributes:React.PropTypes.object.isRequired,attributeDatatypes:React.PropTypes.object.isRequired,capacities:React.PropTypes.object.isRequired},exports.default=SpecimenCollectionForm},function(module,exports){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),ContainerParentForm=function(_React$Component){function ContainerParentForm(props){_classCallCheck(this,ContainerParentForm);var _this=_possibleConstructorReturn(this,(ContainerParentForm.__proto__||Object.getPrototypeOf(ContainerParentForm)).call(this,props));return _this.state={formData:{},formErrors:{},errorMessage:null},_this.mapFormOptions=_this.mapFormOptions.bind(_this),_this.handleSubmit=_this.handleSubmit.bind(_this),_this.setFormData=_this.setFormData.bind(_this),_this}return _inherits(ContainerParentForm,_React$Component),_createClass(ContainerParentForm,[{key:"componentDidMount",value:function(){if(this.props.container){var formData=this.state.formData;formData.container=JSON.stringify(this.props.container),formData.parentContainerId=this.props.container.parentContainerId,this.setState({formData:formData})}}},{key:"mapFormOptions",value:function(rawObject,targetAttribute){var data={};for(var id in rawObject)data[id]=rawObject[id][targetAttribute];return data}},{key:"render",value:function(){var parentContainerField,coordinateField,containerBarcodesNonPrimary=this.mapFormOptions(this.props.containersNonPrimary,"barcode");
if(parentContainerField=React.createElement(SelectElement,{name:"parentContainerId",label:"Parent Container Barcode",options:containerBarcodesNonPrimary,onUserInput:this.setFormData,ref:"parentContainerId",required:!1,value:this.state.formData.parentContainerId}),this.state.formData.parentContainerId){var dimensionId=this.props.containersNonPrimary[this.state.formData.parentContainerId].dimensionId;if(dimensionId){var dimensions=this.props.containerDimensions[dimensionId],coordinatesTotal=1;for(var dimension in dimensions)coordinatesTotal*=dimensions[dimension];for(var coordinates={},i=1;i<=coordinatesTotal;i++)this.props.containerCoordinates[this.state.formData.parentContainerId]&&this.props.containerCoordinates[this.state.formData.parentContainerId][i]||(coordinates[i]=i);coordinateField=React.createElement(SelectElement,{name:"coordinate",label:"Coordinate",options:coordinates,onUserInput:this.setFormData,ref:"coordinate",required:!1,value:this.state.formData.coordinate})}}var updateButton;return this.props.container&&(updateButton=React.createElement(ButtonElement,{label:"Update"})),React.createElement(FormElement,{onSubmit:this.handleSubmit},parentContainerField,coordinateField,updateButton)}},{key:"handleSubmit",value:function(){var formData=this.state.formData,formObj=new FormData;for(var key in formData)""!==formData[key]&&formObj.append(key,formData[key]);$.ajax({type:"POST",url:this.props.action,data:formObj,cache:!1,contentType:!1,processData:!1,xhr:function(){var xhr=new window.XMLHttpRequest;return xhr}.bind(this),success:function(){this.props.refreshParent(),swal("Parent Container Update Successful!","","success"),this.props.onSuccess()}.bind(this),error:function(err){console.error(err);var msg=err.responseJSON?err.responseJSON.message:"Specimen error!";this.setState({errorMessage:msg}),swal(msg,"","error")}.bind(this)})}},{key:"setFormData",value:function(formElement,value){var formData=this.state.formData;formData[formElement]=value,"parentContainerId"===formElement&&(formData.coordinate=""),this.setState({formData:formData},this.setParentFormData)}},{key:"setParentFormData",value:function(){if(!this.props.container){var formData=this.state.formData;this.props.setParentFormData(formData)}}}]),ContainerParentForm}(React.Component);ContainerParentForm.propTypes={DataURL:React.PropTypes.string,action:React.PropTypes.string,barcode:React.PropTypes.string,refreshTable:React.PropTypes.func,onSuccess:React.PropTypes.func},exports.default=ContainerParentForm},,,,function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0});var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target},_createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_Modal=__webpack_require__(11),_Modal2=_interopRequireDefault(_Modal),FormModal=function(_React$Component){function FormModal(props){_classCallCheck(this,FormModal);var _this=_possibleConstructorReturn(this,(FormModal.__proto__||Object.getPrototypeOf(FormModal)).call(this,props));return _this.state={show:!1},_this.openModal=_this.openModal.bind(_this),_this.closeModal=_this.closeModal.bind(_this),_this.confirmClose=_this.confirmClose.bind(_this),_this}return _inherits(FormModal,_React$Component),_createClass(FormModal,[{key:"renderChildren",value:function(){var _this2=this;return React.Children.map(this.props.children,function(child){return React.cloneElement(child,{onSuccess:_this2.closeModal})})}},{key:"openModal",value:function(){this.setState({show:!0})}},{key:"confirmClose",value:function(){this.props.throwWarning?swal({title:"Are You Sure?",text:"Leaving the form will result in the loss of any information entered.",type:"warning",showCancelButton:!0,confirmButtonText:"Cancel",cancelButtonText:"Proceed"},function(isConfirm){console.log(isConfirm),isConfirm||this.closeModal()}.bind(this)):this.closeModal()}},{key:"closeModal",value:function(){this.setState({show:!1})}},{key:"render",value:function(){return React.createElement(_Modal2.default,_extends({closeModal:this.confirmClose,openModal:this.openModal,show:this.state.show},this.props),this.renderChildren())}}]),FormModal}(React.Component);FormModal.propTypes={title:React.PropTypes.string,buttonClass:React.PropTypes.string,buttonStyle:React.PropTypes.object,buttonContent:React.PropTypes.object},FormModal.defaultProps={buttonClass:"btn btn-primary"},exports.default=FormModal},function(module,exports){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),Modal=function(_React$Component){function Modal(props){return _classCallCheck(this,Modal),_possibleConstructorReturn(this,(Modal.__proto__||Object.getPrototypeOf(Modal)).call(this,props))}return _inherits(Modal,_React$Component),_createClass(Modal,[{key:"render",value:function(){var modal,backdropStyle={position:"fixed",zIndex:9998,top:0,bottom:0,left:0,right:0,backgroundColor:"rgba(0,0,0,0.3)",padding:50},modalStyle={position:"relative",maxWidth:1e3,maxHeight:"100%",margin:"0 auto",backgroundColor:"#fff",borderRadius:10,overflowY:"auto",zIndex:9999},titleStyle={display:"flex",flexDirection:"row",alignItems:"center",background:"#093782",height:"70px",borderTopRightRadius:"10",color:"#FFFFFF",fontSize:24,padding:20},glyphStyle={marginLeft:"auto",cursor:"pointer"},bodyStyle={padding:15},button=React.createElement("button",{type:"button",className:this.props.buttonClass,onClick:this.props.openModal,style:this.props.buttonStyle},this.props.buttonContent);return this.props.show&&(modal=React.createElement("div",{style:backdropStyle,onClick:this.props.closeModal},React.createElement("div",{style:modalStyle,onClick:function(e){e.stopPropagation()}},React.createElement("div",{style:titleStyle},this.props.title,React.createElement("span",{className:"glyphicon glyphicon-remove",style:glyphStyle,onClick:this.props.closeModal})),React.createElement("div",{style:bodyStyle},this.props.children)))),React.createElement("div",null,button,modal)}}]),Modal}(React.Component);Modal.propTypes={title:React.PropTypes.string,buttonClass:React.PropTypes.string,buttonStyle:React.PropTypes.object,buttonContent:React.PropTypes.object,show:React.PropTypes.boolean,closeModal:React.PropTypes.func,openModal:React.PropTypes.func},Modal.defaultProps={buttonClass:"btn btn-primary"},exports.default=Modal},function(module,exports){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),Loader=function(_React$Component){function Loader(props){return _classCallCheck(this,Loader),_possibleConstructorReturn(this,(Loader.__proto__||Object.getPrototypeOf(Loader)).call(this,props))}return _inherits(Loader,_React$Component),_createClass(Loader,[{key:"render",value:function(){return React.createElement("div",{className:"loader-container"},React.createElement("div",{className:"loader"}))}}]),Loader}(React.Component);exports.default=Loader},,,,function(module,exports){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),LifeCycle=function(_React$Component){function LifeCycle(props){_classCallCheck(this,LifeCycle);var _this=_possibleConstructorReturn(this,(LifeCycle.__proto__||Object.getPrototypeOf(LifeCycle)).call(this,props));return _this.state={},_this}return _inherits(LifeCycle,_React$Component),_createClass(LifeCycle,[{key:"componentDidMount",value:function(){$('[data-toggle="tooltip"]').tooltip()}},{key:"render",value:function(){var collectionNode=void 0,collectionTooltip=void 0;this.props.collection&&(collectionTooltip=React.createElement("div",null,React.createElement("h",null,"Collection"),React.createElement("p",null,"Date:")),collectionNode=React.createElement("div",{className:"lifecycle-node",id:"lifecycle-collection-node","data-html":"true","data-toggle":"tooltip","data-placement":"auto",title:"<h5>"+this.props.sites[this.props.collection.locationId]+"</h5><h5>"+this.props.collection.date+"</h5>"},React.createElement("div",{className:"letter"},"C")));var preparationNode=void 0;this.props.preparation&&(preparationNode=React.createElement("div",{className:"lifecycle-node","data-html":"true","data-toggle":"tooltip","data-placement":"auto",title:"<h5>"+this.props.sites[this.props.preparation.locationId]+"</h5><h5>"+this.props.preparation.date+"</h5>"},React.createElement("div",{className:"letter"},"P")));var analysisNode=void 0;this.props.analysis&&(analysisNode=React.createElement("div",{className:"lifecycle-node-container"},React.createElement("div",{className:"lifecycle-node"}),React.createElement("div",{className:"lifecycle-text"},"Analysis")));var line=void 0;return line=React.createElement("div",{className:"lifecycle-line"}),React.createElement("div",{className:"lifecycle"},React.createElement("div",{className:"lifecycle-graphic"},collectionNode,preparationNode?line:null,preparationNode,analysisNode))}}]),LifeCycle}(React.Component);LifeCycle.propTypes={},exports.default=LifeCycle},,function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_collectionForm=__webpack_require__(5),_collectionForm2=_interopRequireDefault(_collectionForm),_preparationForm=__webpack_require__(19),_preparationForm2=_interopRequireDefault(_preparationForm),_containerParentForm=__webpack_require__(6),_containerParentForm2=_interopRequireDefault(_containerParentForm),_FormModal=__webpack_require__(10),_FormModal2=_interopRequireDefault(_FormModal),_Panel=__webpack_require__(2),_Loader=(_interopRequireDefault(_Panel),__webpack_require__(12)),_Loader2=_interopRequireDefault(_Loader),_specimenForm=__webpack_require__(3),_specimenForm2=_interopRequireDefault(_specimenForm),_lifeCycle=__webpack_require__(16),_lifeCycle2=_interopRequireDefault(_lifeCycle),BiobankSpecimen=function(_React$Component){function BiobankSpecimen(props){_classCallCheck(this,BiobankSpecimen);var _this=_possibleConstructorReturn(this,(BiobankSpecimen.__proto__||Object.getPrototypeOf(BiobankSpecimen)).call(this,props));return _this.state={Data:{},isLoaded:!1,loadedData:0,editCollection:!1,editPreparation:!1},_this.fetchSpecimenData=_this.fetchSpecimenData.bind(_this),_this.toggleEditCollection=_this.toggleEditCollection.bind(_this),_this.toggleEditPreparation=_this.toggleEditPreparation.bind(_this),_this.mapFormOptions=_this.mapFormOptions.bind(_this),_this.updateCollection=_this.updateCollection.bind(_this),_this.updatePreparation=_this.updatePreparation.bind(_this),_this}return _inherits(BiobankSpecimen,_React$Component),_createClass(BiobankSpecimen,[{key:"componentDidMount",value:function(){this.fetchSpecimenData()}},{key:"fetchSpecimenData",value:function(){var self=this;$.ajax(this.props.specimenPageDataURL,{dataType:"json",success:function(data){self.setState({Data:data,isLoaded:!0})},error:function(_error,errorCode,errorMsg){console.error(_error,errorCode,errorMsg),self.setState({error:"An error occurred when loading the form!"})}})}},{key:"toggleEditCollection",value:function(){var editCollection=this.state.editCollection;this.setState({editCollection:!editCollection})}},{key:"toggleEditPreparation",value:function(){var editPreparation=this.state.editPreparation;this.setState({editPreparation:!editPreparation})}},{key:"updateCollection",value:function(){this.fetchSpecimenData(),this.toggleEditCollection()}},{key:"updatePreparation",value:function(){this.fetchSpecimenData(),this.toggleEditPreparation()}},{key:"mapFormOptions",value:function(rawObject,targetAttribute){var data={};for(var id in rawObject)data[id]=rawObject[id][targetAttribute];return data}},{key:"render",value:function(){var _this2=this;if(void 0!==this.state.error)return React.createElement("div",{className:"alert alert-danger text-center"},React.createElement("strong",null,this.state.error));if(!this.state.isLoaded)return React.createElement(_Loader2.default,null);var parentSpecimenBarcodeValue=void 0;if(this.state.Data.parentSpecimenBarcode){var specimenURL=loris.BaseURL+"/biobank/specimen/?barcode=";parentSpecimenBarcodeValue=React.createElement("a",{href:specimenURL+this.state.Data.parentSpecimenBarcode},this.state.Data.parentSpecimenBarcode)}var parentSpecimenBarcode=React.createElement("div",{className:"item"},React.createElement("div",{className:"field"},"Parent Specimen",React.createElement("div",{className:"value"},parentSpecimenBarcodeValue?parentSpecimenBarcodeValue:"None"))),parentContainerBarcodeValue=void 0;if(this.state.Data.parentContainerBarcode){var containerURL=loris.BaseURL+"/biobank/container/?barcode=";parentContainerBarcodeValue=React.createElement("a",{href:containerURL+this.state.Data.parentContainerBarcode},this.state.Data.parentContainerBarcode)}var parentContainerBarcode=React.createElement("div",{className:"item"},React.createElement("div",{className:"field"},"Parent Container",React.createElement("div",{className:"value"},parentContainerBarcodeValue?parentContainerBarcodeValue:"None"),parentContainerBarcodeValue&&this.state.Data.container.coordinate?"Coordinate "+this.state.Data.container.coordinate:null),React.createElement("div",{className:"action"},React.createElement(_FormModal2.default,{title:"Update Parent Container",buttonContent:React.createElement("div",null,"Move",React.createElement("span",{className:"glyphicon glyphicon-chevron-right",style:{marginLeft:"5px"}}))},React.createElement(_containerParentForm2.default,{containersNonPrimary:this.state.Data.containersNonPrimary,containerDimensions:this.state.Data.containerDimensions,containerCoordinates:this.state.Data.containerCoordinates,container:this.state.Data.container,action:loris.BaseURL+"/biobank/ajax/ContainerInfo.php?action=updateContainerParent",refreshParent:this.fetchSpecimenData})))),addAliquotButton=void 0;if(loris.userHasPermission("biobank_write")){var specimenTypes={};for(var _id in this.state.Data.specimenTypes)this.state.Data.specimenTypes[_id].parentTypeId!=this.state.Data.specimen.typeId&&_id!=this.state.Data.specimen.typeId||(specimenTypes[_id]=this.state.Data.specimenTypes[_id].type);var specimenUnits=this.mapFormOptions(this.state.Data.specimenUnits,"unit"),containerTypesPrimary=this.mapFormOptions(this.state.Data.containerTypesPrimary,"label"),addAliquotButtonContent=React.createElement("div",{className:"specimen-button"},React.createElement("span",{className:"glyphicon glyphicon-plus",style:{marginRight:"5px"}}),"Aliquots");addAliquotButton=React.createElement(_FormModal2.default,{title:"Create Specimen Aliquots",buttonClass:"btn btn-success",buttonStyle:{display:"flex",alignItems:"center"},buttonContent:addAliquotButtonContent},React.createElement(_specimenForm2.default,{action:loris.BaseURL+"/biobank/ajax/SpecimenInfo.php?action=submitSpecimen",child:"true",specimenId:this.state.Data.specimen.id,barcode:this.state.Data.container.barcode,candidateId:this.state.Data.specimen.candidateId,sessionId:this.state.Data.specimen.sessionId,pscid:this.state.Data.candidateInfo[this.state.Data.specimen.candidateId].PSCID,visit:this.state.Data.sessionInfo[this.state.Data.specimen.sessionId].Visit_label,unitId:this.state.Data.specimen.unitId,specimenTypes:specimenTypes,specimenTypeUnits:this.state.Data.specimenTypeUnits,specimenUnits:specimenUnits,containerTypesPrimary:containerTypesPrimary,containersNonPrimary:this.state.Data.containersNonPrimary,containerDimensions:this.state.Data.containerDimensions,containerCoordinates:this.state.Data.containerCoordinates,specimenTypeAttributes:this.state.Data.specimenTypeAttributes,attributeDatatypes:this.state.Data.attributeDatatypes,refreshParent:this.fetchSpecimenData}))}var collectionPanel=void 0,collectionPanelForm=void 0,cancelEditCollectionButton=void 0;if(this.state.editCollection){var _specimenTypes={};for(var id in this.state.Data.specimenTypes)this.state.Data.specimenTypes[this.state.Data.specimen.typeId].parentTypeId?this.state.Data.specimenTypes[id].parentTypeId!=this.state.Data.specimenTypes[this.state.Data.specimen.typeId].parentTypeId&&id!=this.state.Data.specimen.typeId||(_specimenTypes[id]=this.state.Data.specimenTypes[id].type):this.state.Data.specimenTypes[id].parentTypeId||(_specimenTypes[id]=this.state.Data.specimenTypes[id].type);var _containerTypesPrimary=this.mapFormOptions(this.state.Data.containerTypesPrimary,"label");collectionPanelForm=React.createElement(_collectionForm2.default,{specimenId:this.state.Data.specimen.id,specimenType:this.state.Data.specimen.typeId,containerId:this.state.Data.container.id,containerType:this.state.Data.container.typeId,collection:this.state.Data.specimen.collection,specimenTypes:_specimenTypes,specimenTypeAttributes:this.state.Data.specimenTypeAttributes,attributeDatatypes:this.state.Data.attributeDatatypes,containerTypesPrimary:_containerTypesPrimary,specimenTypeUnits:this.state.Data.specimenTypeUnits,edit:!0,action:loris.BaseURL+"/biobank/ajax/SpecimenInfo.php?action=updateSpecimenCollection",toggleEdit:this.toggleEditCollection,refreshParent:this.updateCollection}),cancelEditCollectionButton=React.createElement("a",{className:"pull-right",style:{cursor:"pointer"},onClick:this.toggleEditCollection},"Cancel")}else{if(this.state.Data.specimen.collection.data)var dataObject=this.state.Data.specimen.collection.data,specimenTypeAttributes=Object.keys(dataObject).map(function(key){return React.createElement(StaticElement,{label:_this2.state.Data.specimenTypeAttributes[_this2.state.Data.specimen.typeId][key].name,text:dataObject[key]})});collectionPanelForm=React.createElement(FormElement,null,React.createElement(StaticElement,{label:"Container Type",text:this.state.Data.containerTypesPrimary[this.state.Data.container.typeId].label}),React.createElement(StaticElement,{label:"Quantity",text:this.state.Data.specimen.collection.quantity+" "+this.state.Data.specimenUnits[this.state.Data.specimen.collection.unitId].unit}),React.createElement(StaticElement,{label:"Location",text:this.state.Data.sites[this.state.Data.specimen.collection.locationId]}),specimenTypeAttributes,React.createElement(StaticElement,{label:"Date",text:this.state.Data.specimen.collection.date}),React.createElement(StaticElement,{label:"Time",text:this.state.Data.specimen.collection.time}),React.createElement(StaticElement,{label:"Comments",text:this.state.Data.specimen.collection.comments}))}collectionPanel=React.createElement("div",{className:"panel panel-default"},React.createElement("div",{className:"panel-heading"},React.createElement("div",{className:"lifecycle-node",id:"panel-collection-node"},React.createElement("div",{className:"letter"},"C")),React.createElement("div",{className:"title"},"Collection"),React.createElement("span",{className:this.state.editCollection?null:"glyphicon glyphicon-pencil",onClick:this.state.editCollection?null:this.toggleEditCollection})),React.createElement("div",{className:"panel-body"},collectionPanelForm,cancelEditCollectionButton));var preparationPanel=void 0,preparationForm=void 0,specimenProtocolAttributes=void 0,cancelEditPreparationButton=void 0;if(this.state.editPreparation){specimenProtocolAttributes=this.state.Data.specimenProtocolAttributes[this.state.Data.specimen.typeId];var specimenProtocols={};for(var id in specimenProtocolAttributes)specimenProtocols[id]=this.state.Data.specimenProtocols[id];specimenProtocols=this.mapFormOptions(specimenProtocols,"protocol"),preparationForm=React.createElement(_preparationForm2.default,{specimenId:this.state.Data.specimen.id,preparation:this.state.Data.specimen.preparation?this.state.Data.specimen.preparation:null,specimenProtocols:specimenProtocols,sites:this.state.Data.sites,specimenProtocolAttributes:specimenProtocolAttributes,attributeDatatypes:this.state.Data.attributeDatatypes,insertAction:loris.BaseURL+"/biobank/ajax/SpecimenInfo.php?action=insertSpecimenPreparation",updateAction:loris.BaseURL+"/biobank/ajax/SpecimenInfo.php?action=updateSpecimenPreparation",refreshParent:this.updatePreparation}),cancelEditPreparationButton=React.createElement("a",{className:"pull-right",style:{cursor:"pointer"},onClick:this.toggleEditPreparation},"Cancel")}if(this.state.Data.specimen.preparation&&!this.state.editPreparation){var dataObject=this.state.Data.specimen.preparation.data;dataObject&&(specimenProtocolAttributes=Object.keys(dataObject).map(function(key){return React.createElement(StaticElement,{label:_this2.state.Data.specimenProtocolAttributes[_this2.state.Data.specimen.typeId][_this2.state.Data.specimen.preparation.protocolId][key].name,text:dataObject[key]})})),preparationForm=React.createElement(FormElement,null,React.createElement(StaticElement,{label:"Protocol",text:this.state.Data.specimenProtocols[this.state.Data.specimen.preparation.protocolId].protocol}),React.createElement(StaticElement,{label:"Location",text:this.state.Data.sites[this.state.Data.specimen.preparation.locationId]}),specimenProtocolAttributes,React.createElement(StaticElement,{label:"Date",text:this.state.Data.specimen.preparation.date}),React.createElement(StaticElement,{label:"Time",text:this.state.Data.specimen.preparation.time}),React.createElement(StaticElement,{label:"Comments",text:this.state.Data.specimen.preparation.comments}))}!this.state.Data.specimenProtocolAttributes[this.state.Data.specimen.typeId]||this.state.Data.specimen.preparation||this.state.editPreparation?(this.state.Data.specimen.preparation||this.state.editPreparation)&&(preparationPanel=React.createElement("div",{className:"panel panel-default"},React.createElement("div",{className:"panel-heading"},React.createElement("div",{className:"lifecycle-node"},React.createElement("div",{className:"letter"},"P")),React.createElement("div",{className:"title"},"Preparation"),React.createElement("span",{className:this.state.editPreparation?null:"glyphicon glyphicon-pencil",onClick:this.state.editPreparation?null:this.toggleEditPreparation})),React.createElement("div",{className:"panel-body"},preparationForm,cancelEditPreparationButton))):preparationPanel=React.createElement("div",{className:"panel inactive"},React.createElement("div",{className:"add-process",onClick:this.toggleEditPreparation},React.createElement("span",{className:"glyphicon glyphicon-plus"})),React.createElement("div",null,"ADD PREPARATION"));var analysisPanel=void 0;analysisPanel=React.createElement("div",{className:"panel inactive"},React.createElement("div",{className:"add-process"},React.createElement("span",{className:"glyphicon glyphicon-plus"})),React.createElement("div",null,"ADD ANALYSIS"));var globals=React.createElement("div",{className:"globals"},React.createElement("div",{className:"list"},React.createElement("div",{className:"item"},React.createElement("div",{className:"field"},"Type",React.createElement("div",{className:"value"},this.state.Data.specimenTypes[this.state.Data.specimen.typeId].type))),React.createElement("div",{className:"item"},React.createElement("div",{className:"field"},"Quantity",React.createElement("div",{className:"value"},this.state.Data.specimen.quantity," "+this.state.Data.specimenUnits[this.state.Data.specimen.unitId].unit)),React.createElement("div",{className:"action"},React.createElement(_FormModal2.default,{title:"Update",buttonContent:React.createElement("div",null,"Update",React.createElement("span",{className:"glyphicon glyphicon-chevron-right",style:{marginLeft:"5px"}}))}))),React.createElement("div",{className:"item"},React.createElement("div",{className:"field"},"Status",React.createElement("div",{className:"value"},this.state.Data.containerStati[this.state.Data.container.statusId].status)),React.createElement("div",{className:"action"},React.createElement(_FormModal2.default,{title:"Update",buttonContent:React.createElement("div",null,"Update",React.createElement("span",{className:"glyphicon glyphicon-chevron-right",style:{marginLeft:"5px"}}))}))),React.createElement("div",{className:"item"},React.createElement("div",{className:"field"},"Location",React.createElement("div",{className:"value"},this.state.Data.sites[this.state.Data.container.locationId])),React.createElement("div",{className:"action"},React.createElement(_FormModal2.default,{title:"Ship",buttonContent:React.createElement("div",null,"Ship",React.createElement("span",{className:"glyphicon glyphicon-chevron-right",style:{marginLeft:"5px"}}))}))),parentSpecimenBarcode,parentContainerBarcode,React.createElement("div",{className:"item"},React.createElement("div",{className:"field"},"PSCID",React.createElement("div",{className:"value"},React.createElement("a",{href:loris.BaseURL+"/"+this.state.Data.specimen.candidateId},this.state.Data.candidateInfo[this.state.Data.specimen.candidateId].PSCID)))),React.createElement("div",{className:"item"},React.createElement("div",{className:"field"},"Visit Label",React.createElement("div",{className:"value"},React.createElement("a",{href:loris.BaseURL+"/instrument_list/?candID="+this.state.Data.specimen.candidateId+"&sessionID="+this.state.Data.specimen.sessionId},this.state.Data.sessionInfo[this.state.Data.specimen.sessionId].Visit_label))))));return React.createElement("div",{id:"specimen-page"},React.createElement("div",{className:"specimen-header"},React.createElement("div",{className:"specimen-title"},React.createElement("div",{className:"barcode"},"Barcode",React.createElement("div",{className:"value"},React.createElement("strong",null,this.state.Data.container.barcode))),addAliquotButton),React.createElement(_lifeCycle2.default,{collection:this.state.Data.specimen.collection,
preparation:this.state.Data.specimen.preparation,analysis:this.state.Data.specimen.analysis,sites:this.state.Data.sites})),React.createElement("div",{className:"summary"},globals,React.createElement("div",{className:"processing"},collectionPanel,preparationPanel,analysisPanel)))}}]),BiobankSpecimen}(React.Component);BiobankSpecimen.propTypes={specimenPageDataURL:React.PropTypes.string.isRequired};var RBiobankSpecimen=React.createFactory(BiobankSpecimen);window.BiobankSpecimen=BiobankSpecimen,window.RBiobankSpecimen=RBiobankSpecimen,exports.default=BiobankSpecimen},function(module,exports){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),SpecimenPreparationForm=function(_React$Component){function SpecimenPreparationForm(props){_classCallCheck(this,SpecimenPreparationForm);var _this=_possibleConstructorReturn(this,(SpecimenPreparationForm.__proto__||Object.getPrototypeOf(SpecimenPreparationForm)).call(this,props));return _this.state={formData:{data:{}},currentProtocol:_this.props.preparation?_this.props.preparation.protocolId:null,formErrors:{}},_this.setFormData=_this.setFormData.bind(_this),_this.setSpecimenProtocolFieldFormData=_this.setSpecimenProtocolFieldFormData.bind(_this),_this.getSpecimenProtocolFields=_this.getSpecimenProtocolFields.bind(_this),_this.handleSave=_this.handleSave.bind(_this),_this.savePreparation=_this.savePreparation.bind(_this),_this}return _inherits(SpecimenPreparationForm,_React$Component),_createClass(SpecimenPreparationForm,[{key:"componentDidMount",value:function(){var _this2=this,formData=this.state.formData;if(formData.specimenId=this.props.specimenId,this.props.preparation){formData.protocolId=this.props.preparation.protocolId,formData.locationId=this.props.preparation.locationId,formData.date=this.props.preparation.date,formData.time=this.props.preparation.time,formData.comments=this.props.preparation.comments;var specimenProtocolFieldsObject=this.props.specimenProtocolAttributes[this.state.currentProtocol];if(specimenProtocolFieldsObject){Object.keys(specimenProtocolFieldsObject).map(function(attribute){formData.data[attribute]=_this2.props.preparation.data[attribute]})}}this.setState({formData:formData})}},{key:"render",value:function(){var submitButton;this.props.preparation||(submitButton=React.createElement(ButtonElement,{label:"Submit"}));var updateButton,locationField;this.props.preparation&&(updateButton=React.createElement(ButtonElement,{label:"Update"}),locationField=React.createElement(SelectElement,{name:"locationId",label:"Location",options:this.props.sites,onUserInput:this.setFormData,required:!0,value:this.state.formData.locationId}));var specimenProtocolFields=void 0;if(this.state.currentProtocol){var specimenProtocolFieldsObject=this.props.specimenProtocolAttributes[this.state.currentProtocol];specimenProtocolFieldsObject&&(specimenProtocolFields=this.getSpecimenProtocolFields(specimenProtocolFieldsObject))}return this.state.currentSpecimenProtocol&&(preparationFields=React.createElement("div",null)),React.createElement(FormElement,{name:"specimenPreparation",onSubmit:this.handleSave,ref:"form"},React.createElement(SelectElement,{name:"protocolId",label:"Protocol",options:this.props.specimenProtocols,onUserInput:this.setFormData,required:!0,value:this.state.formData.protocolId}),locationField,specimenProtocolFields,React.createElement(DateElement,{name:"date",label:"Date",onUserInput:this.setFormData,required:!0,value:this.state.formData.date}),React.createElement(TimeElement,{name:"time",label:"Time",onUserInput:this.setFormData,required:!0,value:this.state.formData.time}),React.createElement(TextareaElement,{name:"comments",label:"Comments",onUserInput:this.setFormData,value:this.state.formData.comments}),submitButton,updateButton)}},{key:"setFormData",value:function(formElement,value){var formData=this.state.formData;"protocolId"===formElement&&""!==value&&(formData.data={},this.setState({currentProtocol:value})),formData[formElement]=value,this.setState({formData:formData})}},{key:"setSpecimenProtocolFieldFormData",value:function(formElement,value){var formData=this.state.formData;formData.data[formElement]=value,this.setState({formData:formData})}},{key:"getSpecimenProtocolFields",value:function(fieldsObject){var _this3=this,specimenProtocolFields=Object.keys(fieldsObject).map(function(attribute){var datatype=_this3.props.attributeDatatypes[fieldsObject[attribute].datatypeId].datatype;if("text"===datatype||"number"===datatype){if(null==fieldsObject[attribute].refTableId)return React.createElement(TextboxElement,{name:attribute,label:fieldsObject[attribute].name,onUserInput:_this3.setSpecimenProtocolFieldFormData,ref:attribute,required:fieldsObject[attribute].required,value:_this3.state.formData.data[attribute],hasError:_this3.state.formErrors[attribute],errorMessage:"This is a "+datatype+" field."});if(null!==fieldsObject[attribute].refTableId)return React.createElement(SelectElement,{name:attribute,label:fieldsObject[attribute].name,options:"",onUserInput:_this3.setSpecimenProtocolFieldFormData,ref:attribute,required:fieldsObject[attribute].required,value:_this3.state.formData.data[attribute]})}if("datetime"===datatype)return React.createElement(DateElement,{name:attribute,label:fieldsObject[attribute].name,onUserInput:_this3.setSpecimenProtocolFieldFormData,ref:attribute,required:fieldsObject[attribute].required,value:_this3.state.formData.data[attribute]})});return specimenProtocolFields}},{key:"handleSave",value:function(e){this.props.preparation||this.savePreparation(this.props.insertAction),this.props.preparation&&this.savePreparation(this.props.updateAction)}},{key:"savePreparation",value:function(action){var formData=this.state.formData;formData.data=JSON.stringify(formData.data);var formObj=new FormData;for(var key in formData)""!==formData[key]&&formObj.append(key,formData[key]);$.ajax({type:"POST",url:action,data:formObj,cache:!1,contentType:!1,processData:!1,xhr:function(){var xhr=new window.XMLHttpRequest;return xhr}.bind(this),success:function(){formData.data=JSON.parse(formData.data),this.props.refreshParent(),this.props.onSuccess()}.bind(this),error:function(err){console.error(err);var msg=err.responseJSON?err.responseJSON.message:"Specimen error!";this.setState({errorMessage:msg}),swal(msg,"","error")}.bind(this)})}}]),SpecimenPreparationForm}(React.Component);SpecimenPreparationForm.propTypes={containerTypesPrimary:React.PropTypes.object.isRequired,specimenTypeAttributes:React.PropTypes.object.isRequired,attributeDatatypes:React.PropTypes.object.isRequired,capacities:React.PropTypes.object.isRequired,units:React.PropTypes.object.isRequired},exports.default=SpecimenPreparationForm}]);
//# sourceMappingURL=specimenIndex.js.map